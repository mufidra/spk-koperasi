{% extends "base.html" %}

{% block title %}Nilai Alternatif{% endblock %}
{% block header %}Input Nilai Nasabah{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">
        <h5 class="mb-0">Nilai Nasabah Berdasarkan Kriteria</h5>
    </div>
    <div class="card-body">
        {% if nasabahs %}
        <div class="table-responsive">
            <table class="table table-striped table-bordered">
                <thead>
                    <tr>
                        <th rowspan="2">Nasabah</th>
                        <th colspan="{{ kriterias|length }}" class="text-center">Kriteria</th>
                        <th rowspan="2">Aksi</th>
                    </tr>
                    <tr>
                        {% for kriteria in kriterias %}
                        <th title="{{ kriteria.nama }}">
                            {{ kriteria.kode }}<br>
                            <small class="text-muted">{{ kriteria.bobot }}</small>
                        </th>
                        {% endfor %}
                    </tr>
                </thead>
                <tbody>
                    {% for nasabah in nasabahs %}
                    <tr>
                        <td>
                            <strong>{{ nasabah.kode }}</strong><br>
                            <small>{{ nasabah.nama }}</small>
                        </td>
                        {% for kriteria in kriterias %}
                        <td class="text-center">
                            {% if nilai_dict[nasabah.id][kriteria.id] is defined %}
                            <span class="badge bg-info">{{ nilai_dict[nasabah.id][kriteria.id] }}</span>
                            {% else %}
                            <span class="badge bg-secondary">-</span>
                            {% endif %}
                        </td>
                        {% endfor %}
                        <td>
                            <a href="{{ url_for('edit_nilai', nasabah_id=nasabah.id) }}" 
                               class="btn btn-sm btn-primary">Input/Edit Nilai</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <div class="alert alert-info mt-3">
            <h6>Petunjuk Pengisian Nilai:</h6>
            <table class="table table-sm">
                <tr>
                    <th>C1 (Pinjaman)</th>
                    <td>≤5jt:90, 5-20jt:80, 21-50jt:70, >50jt:60</td>
                </tr>
                <tr>
                    <th>C2 (Tabungan)</th>
                    <td>≥10jt:85, 5-9.999jt:70, <5jt:60</td>
                </tr>
                <tr>
                    <th>C3 (Keaktifan)</th>
                    <td>Sering Menunda:70, Jarang Menunda:60, Tidak Pernah Menunda:50</td>
                </tr>
                <tr>
                    <th>C4 (Keanggotaan)</th>
                    <td>≥5th:75, 3-4th:65, <3th:55</td>
                </tr>
                <tr>
                    <th>C5 (Tunggakan)</th>
                    <td>Tidak:80, 1x:70, ≥2x:60</td>
                </tr>
            </table>
        </div>
        {% else %}
        <div class="alert alert-warning">
            Belum ada data nasabah. Silakan tambah nasabah terlebih dahulu di menu Data Alternatif.
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}