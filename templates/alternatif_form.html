{% extends "base.html" %}

{% block title %}{{ action }} Alternatif{% endblock %}
{% block header %}{{ action }} Data Nasabah{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">
        <h5 class="mb-0">Form {{ action }} Nasabah</h5>
    </div>
    <div class="card-body">
        <form method="POST">
            <!-- Informasi Umum -->
            <h5 class="mb-3 border-bottom pb-2">ðŸ“‹ Informasi Umum</h5>
            <div class="row mb-4">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="kode" class="form-label">Kode Nasabah *</label>
                        <input type="text" class="form-control" id="kode" name="kode" 
                               value="{{ nasabah.kode if nasabah else '' }}" required>
                        <div class="form-text">Contoh: N001, N002, dst.</div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="nama" class="form-label">Nama Lengkap *</label>
                        <input type="text" class="form-control" id="nama" name="nama" 
                               value="{{ nasabah.nama if nasabah else '' }}" required>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="alamat" class="form-label">Alamat</label>
                        <textarea class="form-control" id="alamat" name="alamat" rows="3">{{ nasabah.alamat if nasabah else '' }}</textarea>
                    </div>
                    
                    <div class="mb-3">
                        <label for="telepon" class="form-label">Telepon</label>
                        <input type="text" class="form-control" id="telepon" name="telepon" 
                               value="{{ nasabah.telepon if nasabah else '' }}">
                    </div>
                </div>
            </div>
            
            <!-- Nilai Kriteria -->
            <h5 class="mb-3 border-bottom pb-2">ðŸ“Š Nilai Kriteria</h5>
            <div class="row mb-4">
                {% for kriteria in kriterias %}
                <div class="col-md-6 mb-3">
                    <div class="card">
                        <div class="card-body">
                            <h6 class="card-title">
                                {{ kriteria.kode }}: {{ kriteria.nama }}
                                <span class="badge {% if kriteria.atribut == 'benefit' %}bg-success{% else %}bg-danger{% endif %} float-end">
                                    {{ kriteria.atribut|title }}
                                </span>
                            </h6>
                            <p class="card-text small text-muted">
                                Bobot: <strong>{{ kriteria.bobot }}</strong><br>
                                {% if kriteria.keterangan %}
                                Skor: 
                                {% for line in kriteria.keterangan.split('\n') %}
                                    {% if line.strip() %}
                                    <br><small>{{ line }}</small>
                                    {% endif %}
                                {% endfor %}
                                {% endif %}
                            </p>
                            <div class="input-group">
                                <span class="input-group-text">Nilai</span>
                                <input type="number" class="form-control" 
                                       name="nilai_{{ kriteria.kode }}"
                                       value="{{ nilai_dict[kriteria.kode] if kriteria.kode in nilai_dict else '' }}"
                                       step="1" min="0" max="100" 
                                       placeholder="Masukkan skor"
                                       required>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            
            <!-- Panduan -->
            <div class="alert alert-info">
                <h6>ðŸ“š Panduan Pengisian Nilai:</h6>
                <div class="row">
                    <div class="col-md-6">
                        <p class="mb-1"><strong>C1 - Besarnya Jumlah Pinjaman:</strong></p>
                        <ul class="small mb-2">
                            <li>â‰¤ Rp 5.000.000 â†’ <strong>90</strong></li>
                            <li>Rp 5.000.000 â€“ Rp 20.000.000 â†’ <strong>80</strong></li>
                            <li>Rp 21.000.000 â€“ Rp 50.000.000 â†’ <strong>70</strong></li>
                            <li>> Rp 50.000.000 â†’ <strong>60</strong></li>
                        </ul>
                        
                        <p class="mb-1"><strong>C2 - Banyak Jumlah Tabungan:</strong></p>
                        <ul class="small mb-2">
                            <li>â‰¥ Rp 10.000.000 â†’ <strong>85</strong></li>
                            <li>Rp 5.000.000 â€“ Rp 9.999.999 â†’ <strong>70</strong></li>
                            <li>< Rp 5.000.000 â†’ <strong>60</strong></li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <p class="mb-1"><strong>C3 - Keaktifan:</strong></p>
                        <ul class="small mb-2">
                            <li>Sangat aktif â†’ <strong>80</strong></li>
                            <li>Cukup aktif â†’ <strong>75</strong></li>
                            <li>Kurang aktif â†’ <strong>70</strong></li>
                        </ul>
                        
                        <p class="mb-1"><strong>C4 - Lama Keanggotaan:</strong></p>
                        <ul class="small mb-2">
                            <li>â‰¥ 5 tahun â†’ <strong>80</strong></li>
                            <li>3â€“4 tahun â†’ <strong>70</strong></li>
                            <li>< 3 tahun â†’ <strong>60</strong></li>
                        </ul>
                        
                        <p class="mb-1"><strong>C5 - Riwayat Tunggakan:</strong></p>
                        <ul class="small mb-0">
                            <li>Tidak pernah menunggak â†’ <strong>75</strong></li>
                            <li>Pernah menunggak 1 kali â†’ <strong>65</strong></li>
                            <li>Pernah menunggak â‰¥2 kali â†’ <strong>55</strong></li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="d-flex justify-content-between">
                <a href="{{ url_for('alternatif') }}" class="btn btn-secondary">Kembali</a>
                <button type="submit" class="btn btn-primary">Simpan</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}